# [LetsDefend - Presentation As a Malware](https://app.letsdefend.io/challenge/Presentation-As-a-Malware)
Created: 01/04/2024 14:40
Last Updated: 08/06/2024 11:48
* * *
<div align=center>

**Presentation As a Malware**
![e10f4e5a56a6c9733fd82b9bd18bfed3.png](../../_resources/e10f4e5a56a6c9733fd82b9bd18bfed3.png)
</div>
Can ppt file be malware?

File link: ~~[Download link](https://files-ld.s3.us-east-2.amazonaws.com/PO00187.zip)~~ /root/Desktop/ChallengeFiles/PO00187.zip 
Password: infected

NOTE: Do not open on your local environment. It is malicious file.

* * *
## Start Investigation
>What was the general name / category of the malicious file in the analyzed ppt file?

Generated filehash using anything you have or upload it directly into VirusTotal
![010fd4cc0f60c79c7ec36628f1ced5e2.png](../../_resources/010fd4cc0f60c79c7ec36628f1ced5e2.png)
Looking at answer format, the answer is VB:Trojan
```
VB:Trojan
```

> Which of the url addresses it communicates with has been detected as harmful by sandboxes?

Lets go to Relations tab
![52d9d314b73ddbb853ae3abec3248ef0.png](../../_resources/52d9d314b73ddbb853ae3abec3248ef0.png)
There is one url that has the most vendors flagged as malicious, look like it tried to download suspicious lnk file
```
http://onedrive.linkpc.net/Ali/Yasine/IDMan.lnk
```

> What is the name of the htm file that drops to disk?

Scroll down to Dropped Files section
![2535200bae7350601e750e67a0c762a8.png](../../_resources/2535200bae7350601e750e67a0c762a8.png)
There is a file that has htm extension which match answer format of this question
```
hdkjashdkasbctdgjsa[1].htm
```

> Which process is running to persistent under mshta.exe after the relevant malware runs?

Go to Processes Tree section under Behavior Tab
![affcf1e516c85f46dfb01edacabe0d49.png](../../_resources/affcf1e516c85f46dfb01edacabe0d49.png)
There is a task scheduler process that could be used to stay persistence here so the answer is 
```
schtasks.exe
```

> If there was a snort IDS in the environment at the time of the incident, which rules would it match?

Go to Crowdsourced IDS rules Under Behavior Tab
![fd2cf861b58c5dd23da045bf74396856.png](../../_resources/fd2cf861b58c5dd23da045bf74396856.png)
```
EVENT_CTE_HEADER
```

* * *
## Summary

On this challenge, we learn how to analyze a malicious PPX file on VirusTotal which we will go through
- threat label
- contact urls/domains
- file dropped
- persistent behavior 
- IDS Snort rules

<div align=center>

![d23505efce94144e2422c0e3e4fb51d0.png](../../_resources/d23505efce94144e2422c0e3e4fb51d0.png)
</div>

* * *
